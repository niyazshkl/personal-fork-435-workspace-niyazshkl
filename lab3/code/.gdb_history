p $ebp
p &buffer
b bof
run < badfile
p &buffer
p $ebp
x/200xb &buffer
p &buffer
p $ebp
x/200xb &buffer
x/4xb $ebp+4
x/i $ebp+4
x/32i 0xffffc584
b bof
run < badfile
p &buffer
p $ebp
x/200xb &buffer
p &buffer
p $ebp
x/200xb &buffer
x/4xb $ebp+4
x/i $ebp+4
x/32i 0xffffc584
b bof
run
p $buffer
p &buffer
p $ebp
x/200xb &buffer
x/4xb $ebp+4
x/i $ebp+4
c
b bof
run
p $buffer
p &buffer
p $ebp
x/200xb &buffer
x/4xb $ebp+4
x/i $ebp+4
c
b bof
run
c
b bof
run
c
b bof
run
quit
b bof
run
p $buffer
p &buffer
p $ebp
quit
b bof
run
p &buffer
p $esp
p $ebp
exit
b bof
run
p &buffer
p $esp
p $epb
p $ebp
exit
b bof
rn
run
p &buffer
p $ehp
p $ebp
quit
b bof
run
next
p &buffer
p $ebp
x/200xb &buffer
x/4xb $ebp+4
x/i $ebp+4
p/x *(unsigned int*)($ebp+4)
set $ret = *(unsigned int*)($ebp+4)
printf "ret = %p\n", $ret
x/32i $ret
c
p $ebp
bt
p $ebp
exit
b bof
run
p/x *(unsigned int*)($ebp)
p $ebp
p/x $ebp
exit
b bof
run
p/x &buffer
p/x $ebp
p/x *(unsigned int*)($ebp)
next
p &buffer
p $ebp
x/200xb &buffer
x/4xb $esp+4
x/i $esp+4
p/x *(unsigned int*)($ebp+4)
set $ret = *(unsigned int*)($ebp+4)
printf "ret = %p\n", $ret
x/64i $ret
c
clear
exit
b bof
run
p/x &buffer
p/x $ebp
p/x *(unsigned int*)($ebp)
next
x/200xb &buffer
x/8xb buffer_addr+16
x/8xb 0xffffc3e8
x/8xb 0xffffc498
p/x *(unsigned int*)($ebp+4)
set $ret = *(unsigned int*)($ebp+4)
print "ret = %p\n", $ret
x/64i $ret
c
bt
info registers 
x/i $eip
b *0x56556240
continue
si
exit
b bof
run
p/x &buffer
p/x $ebp
p/x *(unsigned int*)($ebp)
next
info registers 
p/x $esp
p/x $ebp
x/8xb $esp
x/16xb $ebp-16
si
info registers 
p/x $esp
p/x $ebp
x/8xb $esp
x/8xb $esp+4
p/x *(unsigned int*)($ebp)
exit
b bof
run
p &buffer
p $ebp
p *(unsigned int*) $ebp
exit
b bof
run
p &buffer
p $ebp
p/x *(unsigned int*)($ebp)
exit
b bof
run
next
si
si
info registers 
si
info registers 
x/16xb $esp
si
p/x $eip
x/32i $eip
c
b bof
run
next
si
si
info registers 
si
info registers 
x/16xb $esp
si
p/x $eip
x/32i $eip
c
b bof
run
clear
next
si
info registers 
p/x $ebp
p &buffer
p/x $esp
x/16xb $esp
si
info registers
p/x $ebp
p/x $esp
x/16xb $esp
clear
si
info registers 
p/x $ebp
p/x $esp
x/16xb $esp
clear
si
info registers 
p/x $eip
x/32i $eip
exit
clear
ls
clear
b bof
clear
ls
clear
b bof
b bof
run
next
si
info registers
p/x $esp
p/x $ebp
x/8xb $esp
x/4xb $esp+4
si
c
b bof
run
next
si
info registers
p/x $esp
p/x $ebp
x/8xb $esp
x/4xb $esp+4
si
c
run
exit
